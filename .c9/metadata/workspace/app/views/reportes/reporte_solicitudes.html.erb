{"filter":false,"title":"reporte_solicitudes.html.erb","tooltip":"/app/views/reportes/reporte_solicitudes.html.erb","undoManager":{"mark":8,"position":8,"stack":[[{"start":{"row":0,"column":0},"end":{"row":234,"column":0},"action":"remove","lines":["<% content_for :title, 'Reporte de solicitudes' %>","<%= render partial: 'partial/cabecera', ","        locals: {cabecera: {","            titulo: 'Reporte de solicitudes',","            navegacion: [","                {titulo: 'Inicio', ruta: root_path},","                {titulo: 'Reporte de solicitudes', ruta: root_path}]","             }} %>","","<div class=\"wrapper wrapper-content\">","    <div class=\"row\">","        <div class=\"col-lg-12\">","            <div class=\"ibox float-e-margins\">","                <div class=\"ibox-content text-center p-md\">","            ","                    <!--<%=render partial: 'partial/boton_right', ","                    locals: {botones: [","                         {elemento: 'a_blank', titulo: '<i class=\"fa fa-print\"></i> Exportar', ruta: servicios_aprobados_exportar_path, clase: 'btn btn-info'}]","                    } %> -->","                    ","                    <div class=\"row\">","                         <div class=\"navbar-minimalize minimalize-styl-2\" style=\"margin: auto;\">","                              <%= image_tag ( \"ocelot/ocelot-imagotipo.png\"), :style =>'width: 150px;' %>","                              <br>","                             <address>","                                  <strong>OCELOT, C.A.</strong><br>","                                     Avenida Lara, Barquisimeto<br>","                                     Estado Lara, 3001<br>","                                     <abbr title=\"Teléfono\">Tlf:</abbr> 02515555555","                              </address>","                         ","                         ","                          </div><br>","                            ","               ","                                            <div class=\"col-sm-9 text-right\">","                                               ","                                                <p>","                                                    <span><strong>Fecha de emisión:</strong>  ","                                                    28/03/2017</span><br/>","                                                  ","                                                </p>","                                            </div>","                                            <br><br>","                                        </div>","                    <!-- iniciocontenido reporte -->","            ","            ","                    <form class=\"form-horizontal\">","                        <div class=\"form-group\">","                            <label class=\"col-sm-2 control-label\">Categoría de servicio</label>","                            <div class=\"col-sm-4\">","                                    <select data-placeholder=\"Seleccione una categoría de servicio...\" class=\"chosen-select\"tabindex=\"2\">","                                        <option value=\"\">Seleccione</option>","                                        <option value=\"instalacion\">Instalación</option>","                                        <option value=\"mantenimiento\">Mantenimiento</option>","                                        <option value=\"reparacion\">Reparación</option>","                                        ","                                    </select>","                            </div>","                            <label class=\"col-sm-2 control-label\"> Tipo de servicio</label>","                            <div class=\"col-sm-4\">","                                <select data-placeholder=\"Seleccione un tipo de servicio...\" class=\"chosen-select\" tabindex=\"2\">","                                    <option value=\"\">Seleccione</option>","                                    <option value=\"jardineria\">Jardinería</option>","                                    <option value=\"pintura\">Pintura</option>","                                    <option value=\"albanileria\">Albañileria</option>","                                    <option value=\"electricidad\">Electricidad</option>","                                    ","                                </select>","                            </div>","                        </div>","                        <div class=\"form-group\">","                            <label class=\"col-sm-1 control-label\">Estado</label>","                            <div class=\"col-sm-3\">","                                    <select data-placeholder=\"Seleccione un estado...\" class=\"chosen-select\"tabindex=\"2\">","                                        <option value=\"\">Seleccione</option>","                                        <option value=\"lara\">Lara</option>","                                        <option value=\"yaracuy\">Yaracuy</option>","                                        <option value=\"portuguesa\">Portuguesa</option>","                                        ","                                    </select>","                            </div>","                            <label class=\"col-sm-1 control-label\"> Ciudad</label>","                            <div class=\"col-sm-3\">","                                <select data-placeholder=\"Seleccione una ciudad...\" class=\"chosen-select\" tabindex=\"2\">","                                    <option value=\"\">Seleccione</option>","                                    <option value=\"barquisimeto\">Barquisimeto</option>","                                    <option value=\"cabudare\">Cabudare</option>                   ","                                </select>","                            </div>","                            <label class=\"col-sm-1 control-label\"> Municipio</label>","                            <div class=\"col-sm-3\">","                                <select data-placeholder=\"Seleccione un municipio ...\" class=\"chosen-select\" tabindex=\"2\">","                                    <option value=\"\">Seleccione</option>","                                    <option value=\"iribarren\">Iribarren</option>","                                           ","                                </select>","                            </div>","                        </div>","","                        <div class=\"form-group\" id=\"data_5\">","                            <label class=\"col-sm-2 control-label\">Rango de fechas a consultar</label>","                            <div class=\"col-sm-10\">","                                <div class=\"input-daterange input-group col-sm-12\" id=\"datepicker\">","                                    <span class=\"input-group-addon\">Desde</span>","                                    <input type=\"text\" class=\"input-sm form-control\" name=\"start\" value=\"05/14/2014\"/>","                                    <span class=\"input-group-addon\">Hasta</span>","                                    <input type=\"text\" class=\"input-sm form-control\" name=\"end\" value=\"05/22/2014\" />","                                </div>","                            </div>","                        </div>   ","                        <div class=\"col-sm-12\">","                            <%=render partial: 'partial/boton_right', ","                    locals: {botones: [","                         {elemento: 'button', id:'generar',titulo: '<i class=\"fa fa-bar-chart\"></i> Generar', clase: 'btn btn-primary',contenido:'<i class=\"fa fa-bar-chart\"></i> Generar'}]","                    } %> ","                        </div>","                    </form>","                    <br>","                    ","                    <div>","                        <div class=\"row\">","                          ","                            <div class=\"col-lg-11 grafico\">","                            <div class=\"ibox float-e-margins\">","                                <div class=\"ibox-title\">","                                    <h5>Reporte de solicitudes</h5>","                                </div> ","                                <div class=\"ibox-content\">","                                    <center>","                                        <div id=\"DataTables_Table_0_wrapper \" class=\"dataTables_wrapper form-inline\" >","                                            <table class=\"table table-hover\">","                                <thead>","                                <tr>","                                    <th>N° Orden</th>","                                    <th>Fecha</th>","                                    <th>Categoría</th>","                                    <th>Tipo de Servicio</th>","                                    <th>Servicio </th>","                                    <th>Estatus</th>","                                ","                                    ","                                </tr>","                                </thead>","                                <tbody>","                                <tr>","                                    <td>001</td>","                                    <td>24/06/2017</td>","                                    <td>Mantenimiento</td>","                                    <td>Jardinería</td>","                                    <td>Corte de grama</td>","                                    <td>Orden de Visita</td>","                                    ","                                <tr>","                                    <td>002</td>","                                    <td>28/06/2017</td>","                                    <td>Instalación</td>","                                    <td>Eléctrica</td>","                                    <td>Instalación Lamparas</td>","                                    <td>Culminado</td>","                                    ","                                </tr>","                                </tr>","                                ","                                ","                                </tbody>","                            </table>","                            <div>","                            ","                    <div class=\"dataTables_paginate paging_simple_numbers text-right\" id=\"DataTables_Table_0_paginate\">","                    <div class=\"dataTables_info\" id=\"DataTables_Table_0_info\" role=\"status\" aria-live=\"polite\">Páginas 1 a 10 para 57 registros</div>","                    <ul class=\"pagination\">","                    <li class=\"paginate_button previous disabled\" aria-controls=\"DataTables_Table_0\" tabindex=\"0\" id=\"DataTables_Table_0_previous\">","                    <a href=\"#\">Anterior</a>","                    </li>","                    <li class=\"paginate_button active\" aria-controls=\"DataTables_Table_0\" tabindex=\"0\"><a href=\"#\">1</a>","                    </li>","                    <li class=\"paginate_button \" aria-controls=\"DataTables_Table_0\" tabindex=\"0\"><a href=\"#\">2</a>","                    </li>","                    <li  aria-controls=\"DataTables_Table_0\" tabindex=\"0\"><a href=\"#\">3</a></li>","                    <li class=\"paginate_button next\" aria-controls=\"DataTables_Table_0\" tabindex=\"0\" id=\"DataTables_Table_0_next\"><a href=\"#\">Siguiente</a>","                    </li>","                    </ul>","                    </div>","                                        </div>","                                        ","                                    </center>","                                </div>","                        </div>","                    </div>","                        ","                    </div>","            ","                    </div>","                    ","                </div>","            </div>        ","        </div>","    </div>","</div>","","  ","<% content_for :javascript do %>","<script type=\"text/javascript\">","","    $(function() {","        datePickerMultiple();","        $(\".grafico\").hide();","        $(\"#generar\").click(function(){","            $(\".grafico\").show();","        });","        ","    });","    var datePickerMultiple = function() {","        $('.date').datepicker({","            language: 'es',","            startView: 2,","            todayBtn: \"linked\",","            keyboardNavigation: false,","            forceParse: false,","            autoclose: true","        });","    }","    ","        $('#data_5 .input-daterange').datepicker({","                keyboardNavigation: false,","                forceParse: false,","                autoclose: true","            });","    </script>","<% end %>","<!-- Fin Reporte -->","",""],"id":2}],[{"start":{"row":0,"column":0},"end":{"row":338,"column":0},"action":"insert","lines":["<% content_for :title, 'Reporte de solicitudes' %>","<%= render partial: 'partial/cabecera', ","        locals: {cabecera: {","            titulo: 'Reporte de solicitudes',","            navegacion: [","                {titulo: 'Inicio', ruta: root_path},","                {titulo: 'Reporte de solicitudes', ruta: root_path}]","             }} %>","","<div class=\"wrapper wrapper-content\">","    <div class=\"row\">","        <div class=\"col-lg-12\">","            <div class=\"ibox float-e-margins\">","                <div class=\"ibox-content text-center p-md\">","                    <%=render partial: 'partial/boton_right', ","                    locals: {botones: [{elemento: 'a_blank', titulo: '<i class=\"fa fa-print\"></i> Exportar', ruta: reporte_solicitudes_exportar_path, clase: 'btn btn-info'}]}%>","                    <div class=\"row\">","                        <div class=\"navbar-minimalize minimalize-styl-2\" style=\"margin: auto;\">","                            <%= image_tag ( \"ocelot/ocelot-imagotipo.png\"), :style =>'width: 150px;' %>","                            <br>","                            <address>","                                <strong>OCELOT, C.A.</strong><br>","                                    Avenida Lara, Barquisimeto<br>","                                    Estado Lara, 3001<br>","                                 <abbr title=\"Teléfono\">Tlf:</abbr> 02515555555","                            </address>","                        </div><br>","                        <div class=\"col-sm-9 text-right\">","                            <p>","                                <span><strong>Fecha de emisión:</strong>  ","                                    <%=Time.now.strftime(\"%d-%m-%Y\")%>","                                </span>","                        <br/>","                            </p>","                       </div>","                       <br><br>","                    </div>","                    <!-- iniciocontenido reporte -->","                    <form class=\"form-horizontal\" id=\"form1\">","                        <div class=\"form-group\">","                            <label class=\"col-sm-2 control-label\">Categoría de servicio</label>","                            <div class=\"col-sm-4\">","                                <select id=\"categoria\" data-placeholder=\"Seleccione una categoría de servicio...\" class=\"chosen-select\"tabindex=\"2\">","                                    <option value=\"Seleccione\"></option>","                                    <%= @categoria.try(:each) do |opt| %>","                                    <option value=\"<%= opt.id %>\"><%= opt.descripcion %></option>","                                    <%  end %>","                                </select>","                            </div>","                            <label class=\"col-sm-2 control-label\"> Tipo de servicio</label>","                            <div class=\"col-sm-4\">","                                <select id=\"servicio\" data-placeholder=\"Seleccione un tipo de servicio...\" class=\"chosen-select\" tabindex=\"2\">","                                    ","                                </select>","                            </div>","                        </div>","                        <div class=\"form-group\">","                            <label class=\"col-sm-1 control-label\">Estado</label>","                            <div class=\"col-sm-3\">","                                <select id=\"estado\" data-placeholder=\"Seleccione un estado...\" class=\"chosen-select\"tabindex=\"2\">","                                   <option value=\"Seleccione\"></option>","                                    <%= @estado.try(:each) do |opt| %>","                                    <option value=\"<%= opt.id %>\"><%= opt.descripcion %></option>","                                    <%  end %>","                                </select>","                            </div>","                            <label class=\"col-sm-1 control-label\"> Ciudad</label>","                            <div class=\"col-sm-3\">","                                <select id=\"ciudad\" data-placeholder=\"Seleccione\" class=\"chosen-select\" tabindex=\"2\" style=\"text-align: left;\">","                                        ","                                </select>","                            </div>","                            <label class=\"col-sm-1 control-label\"> Municipio</label>","                            <div class=\"col-sm-3\">","                                <select id=\"municipio\" data-placeholder=\"Seleccione un municipio ...\" class=\"chosen-select\" tabindex=\"2\">","                                    ","                                           ","                                </select>","                            </div>","                        </div>","","                        <div class=\"form-group\" id=\"data_5\">","                            <label class=\"col-sm-2 control-label\">Rango de fechas a consultar</label>","                            <div class=\"col-sm-10\">","                                <div class=\"input-daterange input-group col-sm-12\" id=\"datepicker\">","                                    <span class=\"input-group-addon\">Desde</span>","                                    <input type=\"text\" class=\"input-sm form-control\" name=\"start\" value=\"05/14/2014\" id=\"start\"/>","                                    <span class=\"input-group-addon\">Hasta</span>","                                    <input type=\"text\" class=\"input-sm form-control\" name=\"end\" value=\"05/22/2014\" id=\"end\" />","                                </div>","                            </div>","                        </div>   ","                        <div class=\"col-sm-12\">","                            <%=render partial: 'partial/boton_right', ","                    locals: {botones: [","                         {elemento: 'button', id:'generar',titulo: '<i class=\"fa fa-bar-chart\"></i> Generar', clase: 'btn btn-primary',contenido:'<i class=\"fa fa-bar-chart\"></i> Generar'}]","                    } %> ","                        </div>","                    </form>","                    <br>","                    ","                    <div>","                        <div class=\"row\">","                          ","                            <div class=\"col-lg-11 grafico\">","                            <div class=\"ibox float-e-margins\">","                                <div class=\"ibox-title\">","                                    <h5>Reporte de solicitudes</h5>","                                </div> ","                                <div class=\"ibox-content\">","                                    <center>","                                        <div id=\"DataTables_Table_0_wrappe \" class=\"dataTables_wrapper form-inline\" >","                                            <table id=\"dt_tabla\" class=\"table table-hover\">","                                <thead>","                                    <tr>","                                        <th>N° Orden</th>","                                        <th>Fecha</th>","                                        <th>Categoría</th>","                                        <th>Tipo de Servicio</th>","                                        <th>Servicio </th>","                                        <th>Estatus</th>","                                    </tr>","                                </thead>","                                <tbody>","                                </tbody>","                            </table>","                            <div>","                            ","                                        </div>","                                        ","                                    </center>","                                </div>","                        </div>","                    </div>","                        ","                    </div>","            ","                    </div>","                    ","                </div>","            </div>        ","        </div>","    </div>","</div>","","  ","<% content_for :javascript do %>","<script type=\"text/javascript\">","","    $(function() {","        cambiarChosenCategoria();","        cambiarChosenEstado();   ","        cambiarChosenCiudad();   ","        datePickerMultiple();","        $(\".grafico\").hide();","        $(\"#generar\").click(function(){","            $(\".grafico\").show();","            console.log(<%= @solicitudservicio.to_json.html_safe %>);","            listar();","        });","        ","    });","    //Seleccionar Tipo de Servicio por Categoria","    var cambiarChosenCategoria = function() {","    $('#categoria').on('change', function(e) {","        $.ajax({","        url:\"/buscarTipoServicioPorCategoria\",","                data:{","                    url: \"tipoServicio/categoria/\" + $(this).val() +\"/buscarPorCategoria\"","                },","                success:function(data){","                   // console.log(data.ciudad);","                    //toastr.success(data.ciudad[0].id);","                    $(\"#servicio\").empty().trigger(\"chosen:updated\");","                    $(\"#servicio\").append(\"<option value></option>\");","                    $.each(data.tiposervicio, function(key,val) {  ","                        console.log(val.descripcion);","                       // $(\"#ciudad\").append(\"<option></option>\");","                ","                        $(\"#servicio\").append(\"<option value=\\\"\"+val.id+\"\\\">\"+val.descripcion+\"</option>\");","                    }); ","                    $(\"#servicio\").trigger(\"chosen:updated\");","                    ","                },             ","                error:function(data){","                    toastr.error(data.message, \"Oops!\");","                }","            });","        });    ","  "," }","    //Seleccionar Ciudad por Estado","    var cambiarChosenEstado = function() {","    $('#estado').on('change', function(e) {","        $.ajax({","        url:\"/buscarCiudadPorEstado\",","                data:{","                    url: \"ciudad/estado/\" + $(this).val() +\"/buscarPorEstado\"","                },","                success:function(data){","                   // console.log(data.ciudad);","                    //toastr.success(data.ciudad[0].id);","                    $(\"#ciudad\").empty().trigger(\"chosen:updated\");","                    $(\"#ciudad\").append(\"<option value></option>\");","                    $.each(data.ciudad, function(key,val) {  ","                        console.log(val.descripcion);","                       // $(\"#ciudad\").append(\"<option></option>\");","                ","                        $(\"#ciudad\").append(\"<option value=\\\"\"+val.id+\"\\\">\"+val.descripcion+\"</option>\");","                    }); ","                    $(\"#ciudad\").trigger(\"chosen:updated\");","                    ","                },             ","                error:function(data){","                    toastr.error(data.message, \"Oops!\");","                }","            });","        });    ","  "," }","    // seleccionar municipio por Ciudad","    var cambiarChosenCiudad = function(){","    //console.log(\"ayyyyy\");","    $('#ciudad').on('change',function(e){","        //alert(\"Cambioo\");","       $.ajax({","           ","           url:\"/buscarMunicipioPorCiudad\",","          data:{","                    url: \"municipio/ciudad/\" + $(this).val() +\"/buscarPorCiudad\"","                },","            success:function(data){","                //console.log(data.municipio);","                //toastr.success(data.municipio[0].id);","                 $(\"#municipio\").empty().trigger(\"chosen:updated\");","                 $(\"#municipio\").append(\"<option value></option>\");","                   $.each(data.municipio, function(key,val) {","                       console.log(val.descripcion);","                       ","                       $(\"#municipio\").append(\"<option value=\\\"\"+val.id+\"\\\">\"+val.descripcion+\"</option>\");","                       ","                   });","                   ","                   $(\"#municipio\").trigger(\"chosen:updated\");","                 ","            },    ","            ","            error:function(data){","                    toastr.error(data.message, \"Oops!\");","                ","            }   ","       });","    });","    ","    ","} //Fin function ","    ","    ","    ","    var generarlista = function(id, title, footerVisible, disable){","    var fechaIni=$(\"#start\").val();","    var fechaFin=$(\"#end\").val();","","    if($(\"#form1\").valid() && validar_fechas(fechaIni,fechaFin))","    {","       ","       id_ciudad=$(\"#ciudad\").val();","       id_categoria=$(\"#categoria\").val();","       id_tipo_servicio=$(\"#servicio\").val();","       fecha_inicio=$(\"#start\").val();","       fecha_fin=$(\"#end\").val();","        ","    $.ajax({","           url:'/buscar_reporte_estructurado_solicitud',","           data:{","    \t           id_ciudad: id_ciudad,","    \t            id_categoria: id_categoria,","    \t            id_tipo_servicio:id_tipo_servicio,","    \t            fecha_inicio: fecha_inicio,","                    fecha_fin: fecha_fin","    \t       },","    \t       success:function(data){","   ","\t       \t    if (data.status == 200) {","\t       \t        alert(\"hola\");","\t       \t         } else { toastr.error(data.message, \"Oops!\"); }","\t       },","\t       error:function(data){ toastr.error(data.message, \"Oops!\"); }","\t   });","    }","}","            ","            ","    var listar = function() {   ","        var table = $( '#dt_tabla' ).DataTable({","            bLengthChange : false,","            dom: '<\"pull-left\"f><\"pull-right\"l>tip' ,","            bDestroy: true,","            data: <%= @solicitudservicio.to_json.html_safe %>,","            order: [[ 1, \"asc\" ]],","            columns: [","              ","                {data: \"id\"},","                { data: \"fecha_creacion\"},","                {data: \"servicioDes.tipoServicioDes.categoriaDes.descripcion\"},","                ","                {data: \"servicioDes.tipoServicio_descripcion\"},","                {data: \"servicioDes.titulo\"},","                {data: \"descripcionEstatus\"}","                ","            ],","            language: data_table_language","        });","        dateTable_selected(\"#dt_tabla tbody\", table);","        ","       }","","","    var datePickerMultiple = function() {","        $('.date').datepicker({","            language: 'es',","            startView: 2,","            todayBtn: \"linked\",","            keyboardNavigation: false,","            forceParse: false,","            autoclose: true","        });","    }","    ","        $('#data_5 .input-daterange').datepicker({","                keyboardNavigation: false,","                forceParse: false,","                autoclose: true","            });","    </script>","<% end %>","<!-- Fin Reporte -->","",""],"id":3}],[{"start":{"row":78,"column":34},"end":{"row":78,"column":35},"action":"insert","lines":["-"],"id":4}],[{"start":{"row":78,"column":35},"end":{"row":78,"column":36},"action":"insert","lines":["-"],"id":5}],[{"start":{"row":78,"column":36},"end":{"row":78,"column":37},"action":"insert","lines":[">"],"id":6}],[{"start":{"row":72,"column":28},"end":{"row":72,"column":29},"action":"insert","lines":["<"],"id":7}],[{"start":{"row":72,"column":29},"end":{"row":72,"column":30},"action":"insert","lines":["!"],"id":8}],[{"start":{"row":72,"column":30},"end":{"row":72,"column":31},"action":"insert","lines":["-"],"id":9}],[{"start":{"row":72,"column":31},"end":{"row":72,"column":32},"action":"insert","lines":["-"],"id":10}]]},"ace":{"folds":[{"start":{"row":163,"column":45},"end":{"row":190,"column":1},"placeholder":"..."}],"scrolltop":3586,"scrollleft":0,"selection":{"start":{"row":162,"column":4},"end":{"row":191,"column":4},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":37,"state":"start","mode":"ace/mode/html_ruby"}},"timestamp":1512570777941,"hash":"a213fa94d7479e294cabc5101f3b4776ba4ceec6"}